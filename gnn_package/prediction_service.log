2025-04-24 14:37:40,887 - prediction-service - INFO - Creating prediction configuration
2025-04-24 14:37:40,887 - prediction-service - INFO - Loading configuration from model directory: results/test_1yr/default_experiment_20250423_093828/config.yml
2025-04-24 14:37:40,889 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1yr/default_experiment_20250423_093828/config.yml
2025-04-24 14:37:40,889 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:37:40,889 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:37:40,889 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:37:40,889 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:37:40,889 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:37:40,889 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:37:40,890 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:37:40,890 - prediction-service - INFO - Running prediction using model: results/test_1yr/default_experiment_20250423_093828/model.pth
2025-04-24 14:37:40,890 - prediction-service - INFO - Output will be saved to: results/test_1yr/default_experiment_20250423_093828/predictions/predictions_143740.csv
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:37:40,892 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:37:40,894 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-24 14:37:40,894 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:37:40,894 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:37:40,894 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:37:40,895 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:37:40,895 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:37:40,895 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:37:40,895 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp3748eqht.yml
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:37:40,899 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:37:40,899 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp3748eqht.yml
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-24 14:37:40,900 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-24 14:37:40,951 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp3748eqht.yml
2025-04-24 14:37:40,951 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1yr/default_experiment_20250423_093828/model.pth
2025-04-24 14:37:40,951 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp3748eqht.yml
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp3748eqht.yml
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-24 14:37:40,951 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-24 14:37:40,953 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-24 14:37:40,953 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-24 14:37:40,953 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-24 14:37:40,953 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-24 14:37:40,953 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-24 14:37:40,953 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-24 14:37:40,953 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-24 14:37:42,322 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-24 14:37:42,323 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-24 14:37:43,645 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-24 14:37:44,568 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-24 14:37:45,904 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-24 14:37:46,458 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-24 14:37:46,458 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-24 14:37:46,495 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([59, 59])
2025-04-24 14:37:47,267 - gnn_package.src.training.stgnn_prediction - INFO - Overall MSE: 5634.5149, MAE: 6.2240
2025-04-24 14:37:47,272 - gnn_package.src.training.stgnn_prediction - INFO - Predictions saved to results/test_1yr/default_experiment_20250423_093828/predictions/predictions_143740.csv
2025-04-24 14:37:47,272 - prediction-service - INFO - Generated 354 predictions for 59 sensors
2025-04-24 14:37:47,273 - prediction-service - INFO - Overall MSE: 5634.5149, MAE: 6.2240
2025-04-24 14:37:47,276 - prediction-service - INFO - Summary saved to results/test_1yr/default_experiment_20250423_093828/predictions/summary_143740.txt
2025-04-24 14:38:43,795 - prediction-service - INFO - Creating prediction configuration
2025-04-24 14:38:43,795 - prediction-service - INFO - Loading configuration from model directory: results/test_1yr/default_experiment_20250423_093828/config.yml
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1yr/default_experiment_20250423_093828/config.yml
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:38:43,799 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:38:43,799 - prediction-service - INFO - Running prediction using model: results/test_1yr/default_experiment_20250423_093828/model.pth
2025-04-24 14:38:43,799 - prediction-service - INFO - Output will be saved to: results/test_1yr/default_experiment_20250423_093828/predictions/predictions_143843.csv
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:38:43,801 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:38:43,803 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-24 14:38:43,804 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:38:43,804 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:38:43,804 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:38:43,804 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:38:43,804 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:38:43,804 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:38:43,804 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:38:43,809 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp2vthozqp.yml
2025-04-24 14:38:43,809 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-24 14:38:43,809 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-24 14:38:43,809 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-24 14:38:43,810 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-24 14:38:43,810 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-24 14:38:43,810 - gnn_package.config.config - INFO - Model save path: models
2025-04-24 14:38:43,810 - gnn_package.config.config - INFO - Results directory: results
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp2vthozqp.yml
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-24 14:38:43,810 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-24 14:38:43,859 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp2vthozqp.yml
2025-04-24 14:38:43,859 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1yr/default_experiment_20250423_093828/model.pth
2025-04-24 14:38:43,859 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp2vthozqp.yml
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp2vthozqp.yml
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-24 14:38:43,859 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-24 14:38:43,861 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-24 14:38:43,861 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-24 14:38:43,861 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-24 14:38:43,861 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-24 14:38:43,861 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-24 14:38:43,861 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-24 14:38:43,861 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-24 14:38:45,126 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-24 14:38:45,127 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-24 14:38:46,419 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-24 14:38:47,238 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-24 14:38:48,528 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-24 14:38:49,105 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-24 14:38:49,106 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-24 14:38:49,146 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([59, 59])
2025-04-24 14:38:49,837 - gnn_package.src.training.stgnn_prediction - INFO - Overall MSE: 5634.5149, MAE: 6.2240
2025-04-24 14:38:49,840 - gnn_package.src.training.stgnn_prediction - INFO - Predictions saved to results/test_1yr/default_experiment_20250423_093828/predictions/predictions_143843.csv
2025-04-24 14:38:49,840 - prediction-service - INFO - Generated 354 predictions for 59 sensors
2025-04-24 14:38:49,840 - prediction-service - INFO - Overall MSE: 5634.5149, MAE: 6.2240
2025-04-24 14:38:49,842 - prediction-service - INFO - Summary saved to results/test_1yr/default_experiment_20250423_093828/predictions/summary_143843.txt
2025-04-24 14:38:49,842 - prediction-service - INFO - Generating visualizations...
2025-04-24 14:38:53,139 - prediction-service - INFO - Visualizations saved to: results/test_1yr/default_experiment_20250423_093828/predictions
2025-04-24 14:38:53,139 - prediction-service - INFO -   - grid_plot: results/test_1yr/default_experiment_20250423_093828/predictions/sensors_grid_143843.png
2025-04-24 14:38:53,139 - prediction-service - INFO -   - error_analysis: results/test_1yr/default_experiment_20250423_093828/predictions/error_analysis_143843.png
