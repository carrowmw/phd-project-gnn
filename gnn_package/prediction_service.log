2025-04-18 14:51:50,845 - prediction-service - INFO - Creating prediction configuration
2025-04-18 14:51:50,845 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 14:51:50,848 - prediction-service - ERROR - Error in prediction service: could not determine a constructor for the tag 'tag:yaml.org,2002:python/object:gnn_package.config.config.GeneralDataConfig'
  in "results/test_1wk/config.yml", line 2, column 12
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 52, in run_prediction_service
    prediction_config = ExperimentConfig(
                        ^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/config/config.py", line 174, in __init__
    self._load_config()
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/config/config.py", line 199, in _load_config
    config_dict = yaml.safe_load(f)
                  ^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/__init__.py", line 125, in safe_load
    return load(stream, SafeLoader)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/__init__.py", line 81, in load
    return loader.get_single_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 51, in get_single_data
    return self.construct_document(node)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 60, in construct_document
    for dummy in generator:
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 413, in construct_yaml_map
    value = self.construct_mapping(node)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 218, in construct_mapping
    return super().construct_mapping(node, deep=deep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 143, in construct_mapping
    value = self.construct_object(value_node, deep=deep)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 100, in construct_object
    data = constructor(self, node)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 427, in construct_undefined
    raise ConstructorError(None, None,
yaml.constructor.ConstructorError: could not determine a constructor for the tag 'tag:yaml.org,2002:python/object:gnn_package.config.config.GeneralDataConfig'
  in "results/test_1wk/config.yml", line 2, column 12
2025-04-18 14:52:20,156 - prediction-service - INFO - Creating prediction configuration
2025-04-18 14:52:20,156 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 14:52:20,161 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 14:52:20,162 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 14:52:20,162 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_145220.csv
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 14:52:20,164 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 14:52:20,167 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpsczmtut0.yml
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 14:52:20,172 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpsczmtut0.yml
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 14:52:20,172 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 14:52:20,210 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpsczmtut0.yml
2025-04-18 14:52:20,210 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 14:52:20,210 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpsczmtut0.yml
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpsczmtut0.yml
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 14:52:20,210 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 14:52:20,212 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 14:52:20,212 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 14:52:20,212 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 14:52:20,212 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 14:52:20,212 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 14:52:20,212 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 14:52:20,212 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 14:52:21,513 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 14:52:21,513 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 14:52:22,771 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:23,488 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:24,819 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:26,150 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:26,868 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:28,084 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:29,373 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:30,144 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:31,581 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:32,979 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:33,830 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:35,285 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:36,697 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:37,516 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:39,052 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:40,495 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:41,305 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:42,938 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:44,391 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:45,223 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:46,936 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:48,307 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:49,190 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:50,675 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:51,955 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:52,774 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:54,105 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:55,539 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:56,358 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:57,792 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:52:59,235 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:00,044 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:01,894 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:03,424 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:04,243 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:05,675 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:07,110 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:07,929 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:09,568 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:11,002 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:11,705 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:12,865 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 14:53:16,042 - prediction-service - ERROR - Error in prediction service: 'dict' object has no attribute 'index'
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 82, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 260, in predict_all_sensors_with_validation
    data = await fetch_recent_data_for_validation(config=config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 93, in fetch_recent_data_for_validation
    return await processor.process_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/data/processors.py", line 306, in process_data
    X_input, masks_input, _ = processor.create_windows_from_grid(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/preprocessing/timeseries_preprocessor.py", line 95, in create_windows_from_grid
    all_timestamps.update(series.index)
                          ^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'index'
2025-04-18 15:02:04,461 - prediction-service - INFO - Creating prediction configuration
2025-04-18 15:02:04,461 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:02:04,465 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:02:04,465 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 15:02:04,465 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_150204.csv
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:02:04,468 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:02:04,470 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp0_ftl9ae.yml
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:02:04,475 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:02:04,475 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp0_ftl9ae.yml
2025-04-18 15:02:04,475 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:02:04,475 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:02:04,475 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:02:04,476 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:02:04,476 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:02:04,476 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:02:04,476 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:02:04,476 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:02:04,503 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp0_ftl9ae.yml
2025-04-18 15:02:04,503 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 15:02:04,503 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp0_ftl9ae.yml
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp0_ftl9ae.yml
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:02:04,503 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:02:04,505 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 15:02:04,505 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 15:02:04,505 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 15:02:04,505 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 15:02:04,505 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 15:02:04,505 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 15:02:04,505 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 15:02:05,730 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 15:02:05,730 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 15:02:06,960 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:07,780 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:09,100 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:10,339 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:11,066 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:12,384 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:13,518 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:14,333 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:15,869 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:17,063 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:17,916 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:19,451 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:20,785 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:21,503 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:22,936 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:24,205 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:24,982 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:26,501 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:27,849 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:28,594 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:30,206 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:31,536 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:32,355 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:33,993 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:35,203 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:35,970 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:37,474 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:38,819 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:39,889 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:41,521 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:43,169 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:44,101 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:45,765 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:47,263 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:48,266 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:49,779 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:51,197 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:52,322 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:54,063 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:55,501 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:56,317 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:02:57,720 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:03:02,126 - prediction-service - ERROR - Error in prediction service: 'dict' object has no attribute 'preprocessing_stats'
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 82, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 260, in predict_all_sensors_with_validation
    data = await fetch_recent_data_for_validation(config=config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 93, in fetch_recent_data_for_validation
    return await processor.process_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/data/processors.py", line 337, in process_data
    result.preprocessing_stats = self.preprocessing_stats
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'preprocessing_stats'
2025-04-18 15:08:05,290 - prediction-service - INFO - Creating prediction configuration
2025-04-18 15:08:05,290 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:08:05,293 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:08:05,293 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 15:08:05,293 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_150805.csv
2025-04-18 15:08:05,295 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:08:05,295 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:08:05,295 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:08:05,295 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:08:05,295 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:08:05,295 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:08:05,295 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:08:05,296 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:08:05,298 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp6p2pn3zj.yml
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:08:05,303 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp6p2pn3zj.yml
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:08:05,304 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:08:05,332 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp6p2pn3zj.yml
2025-04-18 15:08:05,332 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 15:08:05,332 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp6p2pn3zj.yml
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp6p2pn3zj.yml
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:08:05,332 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:08:05,334 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 15:08:05,334 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 15:08:05,334 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 15:08:05,334 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 15:08:05,334 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 15:08:05,334 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 15:08:05,334 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 15:08:06,586 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 15:08:06,586 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 15:08:07,593 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:08,327 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:09,863 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:11,197 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:11,897 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:13,089 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:14,266 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:15,188 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:16,624 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:18,054 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:18,976 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:20,429 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:21,844 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:22,604 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:24,199 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:25,427 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:26,360 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:27,992 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:29,397 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:30,209 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:31,881 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:33,195 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:33,987 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:35,466 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:36,896 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:37,599 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:38,988 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:40,276 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:41,171 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:42,603 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:44,064 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:44,872 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:46,419 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:47,853 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:48,775 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:50,311 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:51,673 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:52,595 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:54,100 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:55,533 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:56,280 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:08:57,516 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:09:01,962 - prediction-service - ERROR - Error in prediction service: 'dict' object has no attribute 'preprocessing_stats'
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 82, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 260, in predict_all_sensors_with_validation
    data = await fetch_recent_data_for_validation(config=config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 93, in fetch_recent_data_for_validation
    return await processor.process_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/data/processors.py", line 337, in process_data
    result.preprocessing_stats = self.preprocessing_stats
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'preprocessing_stats'
2025-04-18 15:12:31,336 - prediction-service - INFO - Creating prediction configuration
2025-04-18 15:12:31,336 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:12:31,340 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:12:31,340 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 15:12:31,340 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_151231.csv
2025-04-18 15:12:31,342 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:12:31,342 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:12:31,342 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:12:31,342 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:12:31,343 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:12:31,343 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:12:31,343 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:12:31,343 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:12:31,345 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp1_g4jw5y.yml
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:12:31,352 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp1_g4jw5y.yml
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:12:31,352 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:12:31,379 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp1_g4jw5y.yml
2025-04-18 15:12:31,379 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 15:12:31,379 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp1_g4jw5y.yml
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp1_g4jw5y.yml
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:12:31,379 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:12:31,381 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 15:12:31,381 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 15:12:31,381 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 15:12:31,382 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 15:12:31,382 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 15:12:31,382 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 15:12:31,382 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 15:12:32,632 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 15:12:32,633 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 15:12:33,905 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:34,694 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:36,116 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:37,549 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:38,380 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:39,621 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:41,071 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:41,873 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:43,314 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:44,683 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:45,639 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:47,178 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:48,580 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:49,428 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:50,898 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:52,277 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:53,094 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:54,586 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:56,188 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:57,021 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:12:58,581 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:00,087 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:01,001 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:03,152 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:04,791 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:05,591 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:07,143 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:08,371 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:09,213 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:10,808 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:12,100 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:12,980 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:14,515 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:15,848 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:16,666 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:18,202 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:19,635 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:20,585 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:22,196 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:23,805 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:24,550 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:25,701 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:30,244 - prediction-service - ERROR - Error in prediction service: 'data_loaders'
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 82, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 263, in predict_all_sensors_with_validation
    data_loaders = data["data_loaders"]
                   ~~~~^^^^^^^^^^^^^^^^
KeyError: 'data_loaders'
2025-04-18 15:13:51,332 - prediction-service - INFO - Creating prediction configuration
2025-04-18 15:13:51,333 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:13:51,336 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:13:51,336 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 15:13:51,336 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_151351.csv
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:13:51,339 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:13:51,342 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:13:51,347 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpfmv0j16o.yml
2025-04-18 15:13:51,347 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 15:13:51,347 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 15:13:51,347 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 15:13:51,347 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 15:13:51,347 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 15:13:51,348 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 15:13:51,348 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpfmv0j16o.yml
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:13:51,348 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:13:51,374 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpfmv0j16o.yml
2025-04-18 15:13:51,375 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 15:13:51,375 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpfmv0j16o.yml
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpfmv0j16o.yml
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 15:13:51,375 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 15:13:51,377 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 15:13:51,377 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 15:13:51,377 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 15:13:51,377 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 15:13:51,377 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 15:13:51,377 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 15:13:51,377 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 15:13:52,577 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 15:13:52,577 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 15:13:53,699 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:54,487 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:55,616 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 15:13:56,169 - prediction-service - ERROR - Error in prediction service: 'data_loaders'
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 82, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 263, in predict_all_sensors_with_validation
    data_loaders = data["data_loaders"]
                   ~~~~^^^^^^^^^^^^^^^^
KeyError: 'data_loaders'
2025-04-18 17:21:42,340 - prediction-service - INFO - Creating prediction configuration
2025-04-18 17:21:42,340 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:21:42,343 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:21:42,343 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 17:21:42,343 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_172142.csv
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:21:42,346 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:21:42,348 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp00ta614b.yml
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:21:42,353 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp00ta614b.yml
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:21:42,353 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:21:42,403 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp00ta614b.yml
2025-04-18 17:21:42,403 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 17:21:42,403 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp00ta614b.yml
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp00ta614b.yml
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:21:42,403 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:21:42,405 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 17:21:42,405 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 17:21:42,405 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 17:21:42,405 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 17:21:42,405 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 17:21:42,405 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 17:21:42,405 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 17:21:43,650 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 17:21:43,650 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 17:21:44,520 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:21:45,481 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:21:46,773 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:21:47,246 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 104 nodes
2025-04-18 17:21:47,247 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-18 17:21:47,278 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([104, 104])
2025-04-18 17:21:47,321 - prediction-service - ERROR - Error in prediction service: Adjacency matrix dimension (104) doesn't match number of nodes (59)
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 82, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 271, in predict_all_sensors_with_validation
    predictions = predict_with_model(model, val_loader, config=config)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 358, in predict_with_model
    predictions = model(x, adj, x_mask)
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/models/stgnn.py", line 418, in forward
    encoded = self.encoder(x, adj, x_mask)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/models/stgnn.py", line 308, in forward
    x_t = gc_layer(x_t, adj, mask_t)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/models/stgnn.py", line 99, in forward
    raise ValueError(
ValueError: Adjacency matrix dimension (104) doesn't match number of nodes (59)
2025-04-18 17:37:08,794 - prediction-service - INFO - Creating prediction configuration
2025-04-18 17:37:08,794 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:37:08,797 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:37:08,797 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 17:37:08,797 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_173708.csv
2025-04-18 17:37:08,799 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 17:37:08,800 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:37:08,800 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:37:08,800 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:37:08,800 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:37:08,800 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:37:08,800 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:37:08,800 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:37:08,802 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpczfvme7f.yml
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:37:08,807 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpczfvme7f.yml
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:37:08,807 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:37:08,808 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:37:08,835 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpczfvme7f.yml
2025-04-18 17:37:08,835 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 17:37:08,836 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpczfvme7f.yml
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpczfvme7f.yml
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:37:08,836 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:37:08,838 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 17:37:08,838 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 17:37:08,838 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 17:37:08,838 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 17:37:08,838 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 17:37:08,838 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 17:37:08,838 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 17:37:10,103 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 17:37:10,104 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 17:37:10,964 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:37:11,971 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:37:13,280 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:37:13,812 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-18 17:37:13,812 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-18 17:37:13,845 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([59, 59])
2025-04-18 17:37:14,665 - gnn_package.src.training.stgnn_prediction - INFO - Overall MSE: 8454.1885, MAE: 8.9649
2025-04-18 17:37:14,671 - gnn_package.src.training.stgnn_prediction - INFO - Predictions saved to predictions/2025-04-18/predictions_173708.csv
2025-04-18 17:37:50,762 - gnn_package.src.training.stgnn_prediction - INFO - Plot saved to predictions/2025-04-18/predictions_173708.png
2025-04-18 17:37:50,762 - prediction-service - INFO - Generated 354 predictions for 59 sensors
2025-04-18 17:37:50,762 - prediction-service - INFO - Overall MSE: 8454.1885, MAE: 8.9649
2025-04-18 17:37:50,762 - prediction-service - INFO - Fetching and preprocessing recent data for validation
2025-04-18 17:37:50,764 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 17:37:50,764 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:37:50,764 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:37:50,764 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:37:50,765 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:37:50,765 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:37:50,765 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:37:50,765 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpw27if9yq.yml
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:37:50,769 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpw27if9yq.yml
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:37:50,770 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:37:50,783 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpw27if9yq.yml
2025-04-18 17:37:50,784 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 17:37:50,784 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpw27if9yq.yml
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpw27if9yq.yml
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:37:50,784 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:37:50,786 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 17:37:50,786 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 17:37:50,786 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 17:37:50,786 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 17:37:50,786 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 17:37:50,786 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 17:37:50,786 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 17:37:51,920 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 17:37:51,920 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 17:37:52,805 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:37:53,727 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:37:55,066 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:37:55,587 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-18 17:37:55,587 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-18 17:37:55,618 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([59, 59])
2025-04-18 17:37:56,254 - gnn_package.src.training.stgnn_prediction - INFO - Overall MSE: 8454.1885, MAE: 8.9649
2025-04-18 17:37:56,256 - gnn_package.src.training.stgnn_prediction - INFO - Predictions saved to predictions/2025-04-18/predictions_173708.csv
2025-04-18 17:38:17,088 - gnn_package.src.training.stgnn_prediction - INFO - Plot saved to predictions/2025-04-18/predictions_173708.png
2025-04-18 17:38:17,094 - prediction-service - INFO - Summary saved to predictions/2025-04-18/summary_173750.txt
2025-04-18 17:51:14,939 - prediction-service - INFO - Creating prediction configuration
2025-04-18 17:51:14,939 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/config.yml
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/config.yml
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:51:14,943 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:51:14,943 - prediction-service - INFO - Running prediction using model: results/test_1wk/model.pth
2025-04-18 17:51:14,943 - prediction-service - INFO - Output will be saved to: predictions/2025-04-18/predictions_175114.csv
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:51:14,946 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:51:14,948 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp896_mrht.yml
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Model save path: models
2025-04-18 17:51:14,954 - gnn_package.config.config - INFO - Results directory: results
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp896_mrht.yml
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:51:14,954 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:51:15,001 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp896_mrht.yml
2025-04-18 17:51:15,001 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/model.pth
2025-04-18 17:51:15,001 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp896_mrht.yml
2025-04-18 17:51:15,001 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp896_mrht.yml
2025-04-18 17:51:15,001 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-18 17:51:15,001 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-18 17:51:15,001 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-18 17:51:15,001 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-18 17:51:15,001 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-18 17:51:15,001 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-18 17:51:15,002 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-18 17:51:15,002 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-18 17:51:15,004 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-18 17:51:15,004 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-18 17:51:15,004 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-18 17:51:15,004 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-18 17:51:15,004 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-18 17:51:15,004 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-18 17:51:15,004 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-18 17:51:16,206 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-18 17:51:16,207 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-18 17:51:16,996 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:51:17,879 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:51:18,996 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-18 17:51:19,481 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-18 17:51:19,481 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-18 17:51:19,515 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([59, 59])
2025-04-18 17:51:20,284 - gnn_package.src.training.stgnn_prediction - INFO - Overall MSE: 8454.4294, MAE: 8.9482
2025-04-18 17:51:20,287 - gnn_package.src.training.stgnn_prediction - INFO - Predictions saved to predictions/2025-04-18/predictions_175114.csv
2025-04-18 17:51:20,287 - prediction-service - INFO - Generated 354 predictions for 59 sensors
2025-04-18 17:51:20,287 - prediction-service - INFO - Overall MSE: 8454.4294, MAE: 8.9482
2025-04-18 17:51:20,289 - prediction-service - INFO - Summary saved to predictions/2025-04-18/summary_175114.txt
2025-04-18 17:51:20,289 - prediction-service - INFO - Generating visualizations...
2025-04-18 17:51:23,613 - prediction-service - INFO - Visualizations saved to: predictions/2025-04-18
2025-04-18 17:51:23,613 - prediction-service - INFO -   - grid_plot: predictions/2025-04-18/sensors_grid_175114.png
2025-04-18 17:51:23,613 - prediction-service - INFO -   - error_analysis: predictions/2025-04-18/error_analysis_175114.png
2025-04-22 15:45:05,543 - prediction-service - INFO - Creating prediction configuration
2025-04-22 15:45:05,543 - prediction-service - INFO - Creating default prediction configuration
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 15:45:05,547 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 15:45:05,549 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 15:45:05,549 - prediction-service - INFO - Running prediction using model: gnn_package/results/test_1mnth/default_experiment_20250418_171039/model.pth
2025-04-22 15:45:05,549 - prediction-service - INFO - Output will be saved to: gnn_package/results/test_1mnth/default_experiment_20250418_171039/predictions/predictions_154505.csv
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 15:45:05,552 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpwm31a4mx.yml
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 15:45:05,558 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpwm31a4mx.yml
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-22 15:45:05,558 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-22 15:45:05,560 - prediction-service - ERROR - Error in prediction service: [Errno 2] No such file or directory: 'gnn_package/results/test_1mnth/default_experiment_20250418_171039/model.pth'
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 88, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 250, in predict_all_sensors_with_validation
    model, config = load_model_for_prediction(model_path, prediction_config)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/utils/config_utils.py", line 136, in load_model_for_prediction
    model.load_state_dict(torch.load(model_path))
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/serialization.py", line 1425, in load
    with _open_file_like(f, "rb") as opened_file:
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/serialization.py", line 751, in _open_file_like
    return _open_file(name_or_buffer, mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/serialization.py", line 732, in __init__
    super().__init__(open(name, mode))
                     ^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'gnn_package/results/test_1mnth/default_experiment_20250418_171039/model.pth'
2025-04-22 15:45:31,663 - prediction-service - INFO - Creating prediction configuration
2025-04-22 15:45:31,663 - prediction-service - INFO - Loading configuration from model directory: results/test_1mnth/default_experiment_20250418_171039/config.yml
2025-04-22 15:45:31,667 - prediction-service - ERROR - Error in prediction service: could not determine a constructor for the tag 'tag:yaml.org,2002:python/object:gnn_package.config.config.GeneralDataConfig'
  in "results/test_1mnth/default_experiment_20250418_171039/config.yml", line 2, column 12
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 57, in run_prediction_service
    prediction_config = ExperimentConfig(
                        ^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/config/config.py", line 174, in __init__
    self._load_config()
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/config/config.py", line 199, in _load_config
    config_dict = yaml.safe_load(f)
                  ^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/__init__.py", line 125, in safe_load
    return load(stream, SafeLoader)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/__init__.py", line 81, in load
    return loader.get_single_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 51, in get_single_data
    return self.construct_document(node)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 60, in construct_document
    for dummy in generator:
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 413, in construct_yaml_map
    value = self.construct_mapping(node)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 218, in construct_mapping
    return super().construct_mapping(node, deep=deep)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 143, in construct_mapping
    value = self.construct_object(value_node, deep=deep)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 100, in construct_object
    data = constructor(self, node)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/yaml/constructor.py", line 427, in construct_undefined
    raise ConstructorError(None, None,
yaml.constructor.ConstructorError: could not determine a constructor for the tag 'tag:yaml.org,2002:python/object:gnn_package.config.config.GeneralDataConfig'
  in "results/test_1mnth/default_experiment_20250418_171039/config.yml", line 2, column 12
2025-04-22 16:01:37,000 - prediction-service - INFO - Creating prediction configuration
2025-04-22 16:01:37,000 - prediction-service - INFO - Loading configuration from model directory: results/test_1mnth/default_experiment_20250418_171039/config.yml
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1mnth/default_experiment_20250418_171039/config.yml
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:01:37,004 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:01:37,004 - prediction-service - INFO - Running prediction using model: results/test_1mnth/default_experiment_20250418_171039/model.pth
2025-04-22 16:01:37,004 - prediction-service - INFO - Output will be saved to: results/test_1mnth/default_experiment_20250418_171039/predictions/predictions_160137.csv
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:01:37,006 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:01:37,008 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:01:37,012 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpltg4gvct.yml
2025-04-22 16:01:37,012 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:01:37,012 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:01:37,012 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:01:37,012 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:01:37,012 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:01:37,013 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:01:37,013 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpltg4gvct.yml
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-22 16:01:37,013 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-22 16:01:37,073 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpltg4gvct.yml
2025-04-22 16:01:37,073 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1mnth/default_experiment_20250418_171039/model.pth
2025-04-22 16:01:37,073 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpltg4gvct.yml
2025-04-22 16:01:37,073 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpltg4gvct.yml
2025-04-22 16:01:37,073 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-22 16:01:37,073 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-22 16:01:37,074 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-22 16:01:37,074 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-22 16:01:37,074 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-22 16:01:37,074 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-22 16:01:37,074 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-22 16:01:37,074 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-22 16:01:37,076 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-22 16:01:37,076 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-22 16:01:37,076 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-22 16:01:37,076 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-22 16:01:37,076 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-22 16:01:37,076 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-22 16:01:37,076 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-22 16:01:38,374 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-22 16:01:38,376 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-22 16:01:39,238 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-22 16:01:40,239 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-22 16:01:41,513 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-22 16:01:42,027 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-22 16:01:42,027 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-22 16:01:42,071 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([59, 59])
2025-04-22 16:01:42,834 - gnn_package.src.training.stgnn_prediction - INFO - Overall MSE: 5638.6511, MAE: 6.2388
2025-04-22 16:01:42,839 - gnn_package.src.training.stgnn_prediction - INFO - Predictions saved to results/test_1mnth/default_experiment_20250418_171039/predictions/predictions_160137.csv
2025-04-22 16:01:42,839 - prediction-service - INFO - Generated 354 predictions for 59 sensors
2025-04-22 16:01:42,839 - prediction-service - INFO - Overall MSE: 5638.6511, MAE: 6.2388
2025-04-22 16:01:42,844 - prediction-service - INFO - Summary saved to results/test_1mnth/default_experiment_20250418_171039/predictions/summary_160137.txt
2025-04-22 16:01:42,844 - prediction-service - INFO - Generating visualizations...
2025-04-22 16:01:46,156 - prediction-service - INFO - Visualizations saved to: results/test_1mnth/default_experiment_20250418_171039/predictions
2025-04-22 16:01:46,156 - prediction-service - INFO -   - grid_plot: results/test_1mnth/default_experiment_20250418_171039/predictions/sensors_grid_160137.png
2025-04-22 16:01:46,156 - prediction-service - INFO -   - error_analysis: results/test_1mnth/default_experiment_20250418_171039/predictions/error_analysis_160137.png
2025-04-22 16:03:04,310 - prediction-service - INFO - Creating prediction configuration
2025-04-22 16:03:04,310 - prediction-service - INFO - Creating default prediction configuration
2025-04-22 16:03:04,312 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 16:03:04,312 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:03:04,313 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:03:04,313 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:03:04,313 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:03:04,313 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:03:04,313 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:03:04,313 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:03:04,315 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:03:04,315 - prediction-service - INFO - Running prediction using model: results/test_1wk/default_experiment_20250418_171039/model.pth
2025-04-22 16:03:04,315 - prediction-service - INFO - Output will be saved to: results/test_1wk/default_experiment_20250418_171039/predictions/predictions_160304.csv
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:03:04,317 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmppiec_0ay.yml
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Model save path: models
2025-04-22 16:03:04,323 - gnn_package.config.config - INFO - Results directory: results
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmppiec_0ay.yml
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-22 16:03:04,323 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-22 16:03:04,324 - prediction-service - ERROR - Error in prediction service: [Errno 2] No such file or directory: 'results/test_1wk/default_experiment_20250418_171039/model.pth'
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 88, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 250, in predict_all_sensors_with_validation
    model, config = load_model_for_prediction(model_path, prediction_config)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/utils/config_utils.py", line 136, in load_model_for_prediction
    model.load_state_dict(torch.load(model_path))
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/serialization.py", line 1425, in load
    with _open_file_like(f, "rb") as opened_file:
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/serialization.py", line 751, in _open_file_like
    return _open_file(name_or_buffer, mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/.venv/lib/python3.11/site-packages/torch/serialization.py", line 732, in __init__
    super().__init__(open(name, mode))
                     ^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/test_1wk/default_experiment_20250418_171039/model.pth'
2025-04-23 09:20:10,943 - prediction-service - INFO - Creating prediction configuration
2025-04-23 09:20:10,943 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/default_experiment_20250423_085553/config.yml
2025-04-23 09:20:10,946 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/default_experiment_20250423_085553/config.yml
2025-04-23 09:20:10,947 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:20:10,947 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:20:10,947 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:20:10,947 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:20:10,947 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:20:10,947 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:20:10,947 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:20:10,947 - prediction-service - INFO - Running prediction using model: results/test_1wk/default_experiment_20250423_085553/model.pth
2025-04-23 09:20:10,947 - prediction-service - INFO - Output will be saved to: results/test_1wk/default_experiment_20250423_085553/predictions/predictions_092010.csv
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:20:10,949 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:20:10,952 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpzvni_uhc.yml
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:20:10,957 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpzvni_uhc.yml
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-23 09:20:10,957 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-23 09:20:10,987 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpzvni_uhc.yml
2025-04-23 09:20:10,987 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/default_experiment_20250423_085553/model.pth
2025-04-23 09:20:10,987 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpzvni_uhc.yml
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmpzvni_uhc.yml
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-23 09:20:10,987 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-23 09:20:10,989 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-23 09:20:10,989 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-23 09:20:10,989 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-23 09:20:10,989 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-23 09:20:10,989 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-23 09:20:10,989 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-23 09:20:10,989 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-23 09:20:12,277 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-23 09:20:12,278 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-23 09:20:13,755 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-23 09:20:14,964 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-23 09:20:15,887 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-23 09:20:16,503 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-23 09:20:16,503 - prediction-service - ERROR - Error in prediction service: data_package must be a dictionary
Traceback (most recent call last):
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/prediction_service.py", line 88, in run_prediction_service
    predictions = await training.predict_all_sensors_with_validation(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 262, in predict_all_sensors_with_validation
    predictions_dict = predict_with_model(model, val_loader, config=config)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/training/stgnn_prediction.py", line 323, in predict_with_model
    validate_data_package(
  File "/Users/administrator/Code/python/phd-project-gnn/gnn_package/src/utils/data_utils.py", line 83, in validate_data_package
    raise ValueError("data_package must be a dictionary")
ValueError: data_package must be a dictionary
2025-04-23 09:23:19,021 - prediction-service - INFO - Creating prediction configuration
2025-04-23 09:23:19,021 - prediction-service - INFO - Loading configuration from model directory: results/test_1wk/default_experiment_20250423_085553/config.yml
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Configuration loaded from: results/test_1wk/default_experiment_20250423_085553/config.yml
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:23:19,023 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:23:19,023 - prediction-service - INFO - Running prediction using model: results/test_1wk/default_experiment_20250423_085553/model.pth
2025-04-23 09:23:19,023 - prediction-service - INFO - Output will be saved to: results/test_1wk/default_experiment_20250423_085553/predictions/predictions_092319.csv
2025-04-23 09:23:19,025 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-23 09:23:19,025 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:23:19,025 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:23:19,025 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:23:19,026 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:23:19,026 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:23:19,026 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:23:19,026 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Configuration loaded from: /Users/administrator/Code/python/phd-project-gnn/gnn_package/config.yml
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:23:19,028 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Configuration loaded from: /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp4dse1pgk.yml
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Experiment: Default Traffic Prediction Experiment (v1.0.0)
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Description: Traffic prediction using spatial-temporal GNN
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Data config: window_size=24, horizon=6
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Model config: hidden_dim=64, layers=2
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Training config: epochs=50, lr=0.001
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Model save path: models
2025-04-23 09:23:19,035 - gnn_package.config.config - INFO - Results directory: results
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp4dse1pgk.yml
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-23 09:23:19,036 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-23 09:23:19,069 - gnn_package.src.training.stgnn_prediction - INFO - Using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp4dse1pgk.yml
2025-04-23 09:23:19,069 - gnn_package.src.training.stgnn_prediction - INFO - Loading model from: results/test_1wk/default_experiment_20250423_085553/model.pth
2025-04-23 09:23:19,069 - gnn_package.src.training.stgnn_prediction - INFO - Loading model using configuration from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp4dse1pgk.yml
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO - Creating STGNN model with config from /var/folders/f3/myxz09w53js5d76yl90pnhk00000gq/T/tmp4dse1pgk.yml
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   input_dim: 1
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   hidden_dim: 64
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   output_dim: 1
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   horizon: 6
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   num_layers: 2
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   num_gc_layers: 2
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   decoder_layers: 2
2025-04-23 09:23:19,069 - gnn_package.src.models.stgnn - INFO -   dropout: 0.2
2025-04-23 09:23:19,071 - gnn_package.src.training.stgnn_prediction - INFO - Loaded model with parameters:
2025-04-23 09:23:19,071 - gnn_package.src.training.stgnn_prediction - INFO -   hidden_dim: 64
2025-04-23 09:23:19,071 - gnn_package.src.training.stgnn_prediction - INFO -   num_layers: 2
2025-04-23 09:23:19,071 - gnn_package.src.training.stgnn_prediction - INFO -   num_gc_layers: 2
2025-04-23 09:23:19,071 - gnn_package.src.training.stgnn_prediction - INFO -   horizon: 6
2025-04-23 09:23:19,071 - gnn_package.src.training.stgnn_prediction - INFO - Model loaded successfully
2025-04-23 09:23:19,071 - gnn_package.src.training.stgnn_prediction - INFO - Fetching and preprocessing recent data for validation
2025-04-23 09:23:20,315 - httpx - INFO - HTTP Request: PUT https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/refresh_token "HTTP/1.1 200 OK"
2025-04-23 09:23:20,316 - root - INFO - Token refresh status: <Response [200 OK]>
2025-04-23 09:23:21,780 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-23 09:23:22,840 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-23 09:23:23,828 - httpx - INFO - HTTP Request: GET https://flask-customer-api.ki8kabg62o4fg.eu-west-2.cs.amazonlightsail.com/traffic/counts "HTTP/1.1 200 OK"
2025-04-23 09:23:24,396 - gnn_package.src.training.stgnn_prediction - INFO - Preprocessed data for 59 nodes
2025-04-23 09:23:24,396 - gnn_package.src.training.stgnn_prediction - INFO - Using device: mps
2025-04-23 09:23:24,426 - gnn_package.src.training.stgnn_prediction - INFO - Input shapes - x: torch.Size([32, 59, 18, 1]), x_mask: torch.Size([32, 59, 18, 1]), adj: torch.Size([59, 59])
2025-04-23 09:23:25,116 - gnn_package.src.training.stgnn_prediction - INFO - Overall MSE: 11272.0777, MAE: 12.2326
2025-04-23 09:23:25,121 - gnn_package.src.training.stgnn_prediction - INFO - Predictions saved to results/test_1wk/default_experiment_20250423_085553/predictions/predictions_092319.csv
2025-04-23 09:23:25,121 - prediction-service - INFO - Generated 354 predictions for 59 sensors
2025-04-23 09:23:25,121 - prediction-service - INFO - Overall MSE: 11272.0777, MAE: 12.2326
2025-04-23 09:23:25,126 - prediction-service - INFO - Summary saved to results/test_1wk/default_experiment_20250423_085553/predictions/summary_092319.txt
2025-04-23 09:23:25,127 - prediction-service - INFO - Generating visualizations...
2025-04-23 09:23:28,228 - prediction-service - INFO - Visualizations saved to: results/test_1wk/default_experiment_20250423_085553/predictions
2025-04-23 09:23:28,228 - prediction-service - INFO -   - grid_plot: results/test_1wk/default_experiment_20250423_085553/predictions/sensors_grid_092319.png
2025-04-23 09:23:28,228 - prediction-service - INFO -   - error_analysis: results/test_1wk/default_experiment_20250423_085553/predictions/error_analysis_092319.png
