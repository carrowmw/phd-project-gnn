stage_3_optimization